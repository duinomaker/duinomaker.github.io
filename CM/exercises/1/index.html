<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 6.3.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="format-detection" content="telephone=no"><title>Chapter 1 Recurrent Problems - duinomaker&#39;s blog</title><meta name="description" content="Solutions to exercises in Concrete Mathematics chapter 1 - Recurrent Problems"><meta property="og:type" content="website"><meta property="og:title" content="Chapter 1 Recurrent Problems"><meta property="og:url" content="https://duinomaker.top/CM/exercises/1/"><meta property="og:site_name" content="duinomaker&#39;s blog"><meta property="og:description" content="Solutions to exercises in Concrete Mathematics chapter 1 - Recurrent Problems"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://duinomaker.top/images/og_image.png"><meta property="article:published_time" content="2020-04-14T14:36:15.000Z"><meta property="article:modified_time" content="2022-05-05T15:32:55.000Z"><meta property="article:author" content="duinomaker"><meta property="article:tag" content="mathematics"><meta property="article:tag" content="programming"><meta property="article:tag" content="algorithm"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://duinomaker.top/images/og_image.png"><meta name="twitter:creator" content="@duinomaker"><meta name="twitter:site" content="@duinomaker"><meta property="fb:admins" content="100043022235251"><link rel="canonical" href="https://duinomaker.top/CM/exercises/1/"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="apple-touch-icon" type="image/png" sizes="57x57" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" type="image/png" sizes="114x114" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" type="image/png" sizes="72x72" href="/images/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" type="image/png" sizes="144x144" href="/images/apple-touch-icon-144x144.png"><link rel="icon" type="image/svg+xml" href="/images/favicon.svg"><link rel="alternate icon" type="image/png" href="/images/favicon.png"><link rel="shortcut icon" type="image/x-icon" sizes="32x32" href="/images/favicon-32x32.ico"><link rel="shortcut icon" type="image/x-icon" sizes="16x16" href="/images/favicon-16x16.ico"><link rel="preload" href="/assets/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous"><link rel="preload" href="/assets/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@latest/css/bulma.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,italic,500,500italic|Source+Code+Pro|Alegreya:400,italic,500,500italic"><link rel="stylesheet" href="/assets/font-awesome/all.min.css"><style>@font-face{font-family:"CMU Concrete";src:local("CMU Concrete Roman"),url(/assets/webfonts/cmu/cmunorm.woff) format("woff"),url(/assets/webfonts/cmu/cmunorm.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:"CMU Concrete";src:local("CMU Concrete Italic"),url(/assets/webfonts/cmu/cmunoti.woff) format("woff"),url(/assets/webfonts/cmu/cmunoti.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"CMU Concrete";src:local("CMU Concrete Bold"),url(/assets/webfonts/cmu/cmunobx.woff) format("woff"),url(/assets/webfonts/cmu/cmunobx.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:"CMU Concrete";src:local("CMU Concrete BoldItalic"),url(/assets/webfonts/cmu/cmunobi.woff) format("woff"),url(/assets/webfonts/cmu/cmunobi.ttf) format("truetype");font-weight:700;font-style:italic}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@latest/styles/atom-one-light.min.css"><link rel="stylesheet" href="/assets/style.css"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand is-flex-center"> <a class="navbar-item navbar-logo" href="/"><img src="/images/misc/logo.svg" alt="Chapter 1 Recurrent Problems" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"> <a class="navbar-item" href="/">Home</a> <a class="navbar-item" href="/archives/">Archives</a> <a class="navbar-item" href="/categories/">Categories</a> <a class="navbar-item" href="/notes/">Notes</a> <a class="navbar-item" href="/about/">About</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column is-12 has-order-2 column-main"><div class="card"><div class="card-content article"><div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto"><div class="level-left"> <time class="level-item has-text-grey" datetime="2020-04-14T14:36:15.000Z">April 14, 2020</time><span class="level-item has-text-grey"><i class="fas fa-user"></i> &nbsp;<a class="has-link-grey" rel="author" href="https://duinomaker.top/">duinomaker</a></span></div></div><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal tex-math"> Chapter 1 Recurrent Problems</h1><div class="content has-math tex-math"><hr><h2 id="Warmups"><a href="#Warmups" class="headerlink" title="Warmups"></a><a href="/images/CM/warmups_1.jpg" class="has-link-grey" style="text-decoration:underline">Warmups</a></h2><h2 id="Homework-exercises"><a href="#Homework-exercises" class="headerlink" title="Homework exercises"></a>Homework exercises</h2><h3 id="1-8"><a href="#1-8" class="headerlink" title="1.8"></a>1.8</h3><p>List $Q_1$ through $Q_6$, we could find out that $Q$ is periodic.</p><p>$$\begin{aligned}Q_m&amp;=\alpha;\\Q_{m+1}&amp;=\beta;\\Q_{m+2}&amp;=(1+\beta)/\alpha;\\Q_{m+3}&amp;=(1+\alpha+\beta)/(\alpha\beta);\\Q_{m+4}&amp;=(1+\alpha)/\beta,\quad\text{for $m\in\{0,5,10,\ldots\}$.}\end{aligned}$$</p><h3 id="1-9a"><a href="#1-9a" class="headerlink" title="1.9a"></a>1.9a</h3><p>$$\begin{aligned}x_1\ldots x_{n}&amp;\leq\left(\frac{x_1+\cdots+x_{n-1}+x_n}{n}\right)^n\qquad\text{by $(n-1)x_n=x_1+\cdots+x_{n-1}$}\\x_1\ldots x_{n}&amp;\leq\left(\frac{(n-1)x_n+x_n}{n}\right)^n\\x_1\ldots x_{n-1}&amp;\leq(x_n)^{n-1}\\x_1\ldots x_{n-1}&amp;\leq\left(\frac{x_1+\cdots+x_{n-1}}{n-1}\right)^{n-1}.\end{aligned}$$</p><h3 id="1-9b"><a href="#1-9b" class="headerlink" title="1.9b"></a>1.9b</h3><p>$$\begin{aligned}x_1\ldots x_n x_{n+1}\ldots x_{2n}&amp;\leq\left(\frac{x_1+\cdots+x_n}{n}\right)^n\left(\frac{x_{n+1}+\cdots+x_{2n}}{n}\right)^n\qquad\text{by $P(2):x_1x_2\leq\left(\frac{x_1+x_2}2\right)^2$}\\&amp;\leq\left(\frac{\left(\frac{x_1+\cdots+x_n+x_{n+1}+\cdots+x_{2n}}2\right)^2}{n^2}\right)^n\\&amp;\leq\left(\frac{x_1+\cdots+x_n+x_{n+1}+\cdots+x_{2n}}{2n}\right)^{2n}.\end{aligned}$$</p><h3 id="1-9c"><a href="#1-9c" class="headerlink" title="1.9c"></a>1.9c</h3><p>For example, $P(5)$ follows from $P(6)$ from $P(3)$ from $P(4)$ from $P(2)$ which is proved to be true. And whenever $n&gt;1$, $P(n)$ is finally based on $P(2)$.</p><h3 id="1-10"><a href="#1-10" class="headerlink" title="1.10"></a>1.10</h3><p>It’s clear that $Q_n=2R_n-1$ if we</p><ol><li>move $n-1$ disks counter-clockwise;</li><li>move the largest disk clockwise;</li><li>move $n-1$ disks counter-clockwise again.</li></ol><p>Then $R_n=2R_n+Q_{n-1}+2$ if we</p><ol><li>move $n-1$ disks counter-clockwise;</li><li>move the largest disk clockwise;</li><li>move $n-1$ disks clockwise;</li><li>move the largest disk clockwise again;</li><li>move $n-1$ disks back counter-clockwise.</li></ol><p>Plug $Q_n=2R_n-1$ in, then $R_n=Q_n+Q_{n-1}+1$.</p><h3 id="1-11a"><a href="#1-11a" class="headerlink" title="1.11a"></a>1.11a</h3><p>Move a double $(n-1)$-tower, then move the two largest disks, which takes $2$ moves, then move the double $(n-1)$-tower again. Let $A_n$ be the minimum number of moves, hence $A_n=2A_{n-1}+2=2^{n+1}-2$.</p><h3 id="1-11b"><a href="#1-11b" class="headerlink" title="1.11b"></a>1.11b</h3><p><del>Let $\require{enclose}\enclose{horizontalstrike}{B_n}$ be the minimum number of moves to move a double $\require{enclose}\enclose{horizontalstrike}{n}$-tower in the original order; $\require{enclose}\enclose{horizontalstrike}{H_n}$ be the minimum number of moves to move a double $\require{enclose}\enclose{horizontalstrike}{n}$-tower except for the bottom disk. Then we have $\require{enclose}\enclose{horizontalstrike}{B_n=H_n+1+B_{n-1}+1+B_{n-1}}$ and $\require{enclose}\enclose{horizontalstrike}{H_n=B_{n-1}+1+B_{n-1}}$.</del></p><p><del>Insert $\require{enclose}\enclose{horizontalstrike}{H_n}$ to the $\require{enclose}\enclose{horizontalstrike}{B_n}$ equation, we could get $\require{enclose}\enclose{horizontalstrike}{B_n=4B_{n-1}+3=4^n-1}$.</del></p><p>By referring to the answer, I found out that my approach above wasn’t correct. I’ve made a mistake that I postulated all disks never change the order during their moves, which is not necessary.</p><p>It can be shown that no strategy does better than $B_n=A_{n-1}+2+A_{n-1}+2+B_{n-1}$. This strategy changes the order of bottom two disks twice but doesn’t care whether the upper disks keep the order during their moves, which is also the reason why we use $A_n$ here. Thus, $B_n=2^{n+2}-5$.</p><h3 id="1-12"><a href="#1-12" class="headerlink" title="1.12"></a>1.12</h3><p>$$A(m_1,\ldots,m_n)=2A(m_1,\ldots,m_{n-1})+m_n.$$</p><p>This is an equation of the “generalized Josephus” type, whose solution is $(m_1\ldots m_k)_2$.</p><h3 id="1-13"><a href="#1-13" class="headerlink" title="1.13"></a>1.13</h3><p>We already know $n$ straight lines define $L_n=\frac{n(n+1)}2+1$ regions on a plane, and when the $n$-th line is added in, $n$ new areas are created.</p><p>Let the zig-zags be extremely narrow to be seen as straight lines to some extent. So when the $n$-th zig-zag is added in, $n$ new areas are created “in the straight line manner.”</p><p>We could also see that when two zig-zags intersect, $8$ new areas are created “around their intersection” in the way shown below:</p><figure class="image"> <img src="/images/CM/exercises-1_1.jpg" class="image illustration"></figure><p>And when the $n$-th zig-zag is added in, there are at most $n-1$ new “intersections.” So</p><p>$$Z\!Z_n=Z\!Z_{n-1}+n+8(n-1)=\frac92n^2+\frac72n+1.$$</p><h3 id="1-14"><a href="#1-14" class="headerlink" title="1.14"></a>1.14</h3><p>$n$ new areas are created when the $n$-th line is added into the plane, which is equal to the maximum number of line segments created by splitting a line with $n-1$ points. Analogously, $L_{n-1}$ new pieces of cheese is created when making the $n$-th slice.</p><p>So, in recurrence form</p><p>$$P_n=\begin{cases}1,&amp;\text{if $n=0$};\\P_{n-1}+L_{n-1},&amp;\text{if $n&gt;0$}.\end{cases}$$</p><p>We have $P_5=26$.</p><h3 id="1-15"><a href="#1-15" class="headerlink" title="1.15"></a>1.15</h3><p>The function $I$ has the same recursion relation as $J$, but with different boundary values, which are $I(2)=2,I(3)=1$.</p><p>Thus, we cannot find a unique $I(1)$ that satisfies this recurrence. So we have to split it into two cases, one with $I(2)=2$ and one with $I(3)=1$.</p><p>Let’s represent in terms of $n=2^m+l$, and let $\beta_0=-1,\beta_1=1$. The recurrence unfolds, binary-wise:</p><p>$$\begin{aligned}I\big((b_mb_{m-1}\ldots b_0)_ 2\big)&amp;=2I\big((b_mb_{m-1}\ldots b_1)_ 2\big)+\beta _ {b_0}\\&amp;\;\;\vdots\\&amp;=2^{m-1}I\big((b_mb_{m-1})_2\big)+\cdots+2\beta _{b_1}+\beta _{b_0}.\end{aligned}$$</p><p>Then we can stop here, so far the function $I$ have the same form as $J$, and the two leading bits $(b_mb_{m-1})_2$ are enough to contain the two cases:</p><p>$$\begin{aligned}J(2)=1,I(2)=2&amp;\implies I(n)-J(n)=2^{m-1};\\J(3)=3,I(3)=1&amp;\implies I(n)-J(n)=-2^m.\end{aligned}$$</p><p>That is to say</p><p>$$I(n)=\begin{cases}J(n)+2^{m-1},&amp;\text{if $0\leq l&lt;2^{m-1}$};\\J(n)-2^m,&amp;\text{if $2^{m-1}\leq l&lt;2^m$}.\end{cases}$$</p><h3 id="1-16"><a href="#1-16" class="headerlink" title="1.16"></a>1.16</h3><p>Express $g(n)$ in the form</p><p>$$g(n)=A(n)\alpha+B(n)\beta_0+C(n)\beta_1+D(n)\gamma.$$</p><p>Let $g(n)=1$, which implies $(\alpha,\beta_0,\beta_1,\gamma)=(1,-2,-2,0)$. Then</p><p>$$A(n)-2B(n)-2C(n)=1.\tag{1}$$</p><p>Let $g(n)=n$, which implies $(\alpha,\beta_0,\beta_1,\gamma)=(1,0,1,-1)$. Then</p><p>$$A(n)+C(n)-D(n)=n.\tag{2}$$</p><p>Let $(\alpha,\beta_0,\beta_1,\gamma)=(1,-2,-2,0)$, which gives $g(n)=3^m$. Then (note we’re representing in terms of $n=2^m+l$)</p><p>$$A(n)=3^m.\tag{3}$$</p><p>Let $(\alpha,\beta_0,\beta_1,\gamma)=(0,0,1,0)$. Similar to the binary expansion in the Josephus problem, we have</p><p>$$C(n)=(b_{m-1}\ldots b_0)_3.\tag{4}$$</p><p>I also checked that for $(1)(2)(3)$ and $(4)$,</p><p>$$\left|\begin{array}{cccc}1&amp;-2&amp;-2&amp;0\\1&amp;0&amp;1&amp;-1\\1&amp;0&amp;0&amp;0\\0&amp;0&amp;1&amp;0\end{array}\right|\neq0.$$</p><p>The recurrence is solvable; hence</p><p>$$\begin{aligned}A(n)&amp;=3^m;\\B(n)&amp;=\big(3^m-2(b_{m-1}\ldots b_0)_ 3-1\big)/2;\\C(n)&amp;=(b_{m-1}\ldots b_0)_ 3;\\D(n)&amp;=3^m+(b_{m-1}\ldots b_0)_3-n.\end{aligned}$$</p><p>Then</p><p>$$\begin{aligned}g(n)&amp;=3^m\alpha+\big(3^m-2(b_{m-1}\ldots b_0)_ 3-1\big)\frac{\beta_0}2+(b_{m-1}\ldots b_0)_ 3\beta_1+\big(3^m+(b_{m-1}\ldots b_0)_ 3-n\big)\gamma\\&amp;=\left(\alpha+\frac{\beta_0}2+\gamma\right)3^m+(-\beta_0+\beta_1+\gamma)(b_{m-1}\ldots b_0)_3-\frac{\beta_0}2-n\gamma.\end{aligned}$$</p></div></div></div><div class="card"><div class="card-content"><h3 class="title is-5 has-text-weight-normal">Comments</h3><div id="valine-thread" class="content"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>new Valine({el:"#valine-thread",notify:!1,verify:!1,app_id:"jUDJCYuOij3UzEzFmRpQer5U-gzGzoHsz",app_key:"h2AVOMeF8QsLYFdVVbbf9d7k",placeholder:"Suggestions are welcome.",lang:"en"})</script></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start has-text-centered-mobile has-mb-6-mobile"><p>This work is licensed under a <a rel="license noopener external nofollow noreferrer" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons License</a></p></div><div class="level-end has-text-centered-mobile has-mb-5-mobile"><p class="is-size-7">&copy;&nbsp;2020<span style="padding-left:.06em">–</span>2023&nbsp;duinomaker<span>&nbsp;&nbsp;|&nbsp;&nbsp;</span><i class="fas fa-file-word"></i>&nbsp;57.5k&nbsp;words in total<span>&nbsp;&nbsp;|&nbsp;&nbsp;</span><a class="has-link-black-ter" rel="license noopener external nofollow noreferrer" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank"><i class="fab fa-creative-commons"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-nc"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-sa"></i></a></p></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script>var IcarusThemeSettings={site:{url:"https://duinomaker.top",external_link:{enable:!0,exclude:[]}},article:{highlight:{clipboard:!1,fold:"unfolded"}}}</script><script>window.MathJax={chtml:{matchFontHeight:!1,displayAlign:"left",displayIndent:"2em"},tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],packages:{"[+]":["noerrors"]}},svg:{fontCache:"global",displayAlign:"left",displayIndent:"2em"},options:{ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process",renderActions:{addMenu:[]}},loader:{load:["[tex]/noerrors"]}}</script><script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script><script src="/assets/main.js" defer="defer"></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/assets/content.json"}</script><script src="/assets/insight.js" defer="defer"></script><link rel="stylesheet" href="/assets/search.css"><link rel="stylesheet" href="/assets/insight.css"></body></html>