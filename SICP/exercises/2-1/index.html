<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 6.3.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="format-detection" content="telephone=no"><title>2.1 Introduction to Data Abstraction - duinomaker&#39;s blog</title><meta name="description" content="Solutions to exercises in SICP section 2.1 - Introduction to Data Abstraction"><meta property="og:type" content="website"><meta property="og:title" content="2.1 Introduction to Data Abstraction"><meta property="og:url" content="https://duinomaker.top/SICP/exercises/2-1/"><meta property="og:site_name" content="duinomaker&#39;s blog"><meta property="og:description" content="Solutions to exercises in SICP section 2.1 - Introduction to Data Abstraction"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://duinomaker.top/images/og_image.png"><meta property="article:published_time" content="2020-04-15T15:26:34.000Z"><meta property="article:modified_time" content="2021-05-11T08:53:56.000Z"><meta property="article:author" content="duinomaker"><meta property="article:tag" content="mathematics"><meta property="article:tag" content="programming"><meta property="article:tag" content="algorithm"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://duinomaker.top/images/og_image.png"><meta name="twitter:creator" content="@duinomaker"><meta name="twitter:site" content="@duinomaker"><meta property="fb:admins" content="100043022235251"><link rel="canonical" href="https://duinomaker.top/SICP/exercises/2-1/"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="apple-touch-icon" type="image/png" sizes="57x57" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" type="image/png" sizes="114x114" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" type="image/png" sizes="72x72" href="/images/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" type="image/png" sizes="144x144" href="/images/apple-touch-icon-144x144.png"><link rel="icon" type="image/svg+xml" href="/images/favicon.svg"><link rel="alternate icon" type="image/png" href="/images/favicon.png"><link rel="shortcut icon" type="image/x-icon" sizes="32x32" href="/images/favicon-32x32.ico"><link rel="shortcut icon" type="image/x-icon" sizes="16x16" href="/images/favicon-16x16.ico"><link rel="preload" href="/assets/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous"><link rel="preload" href="/assets/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@latest/css/bulma.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,italic,500,500italic|Source+Code+Pro|Alegreya:400,italic,500,500italic"><link rel="stylesheet" href="/assets/font-awesome/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@latest/styles/atom-one-light.min.css"><link rel="stylesheet" href="/assets/style.css"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand is-flex-center"> <a class="navbar-item navbar-logo" href="/"><img src="/images/misc/logo.svg" alt="2.1 Introduction to Data Abstraction" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"> <a class="navbar-item" href="/">Home</a> <a class="navbar-item" href="/archives/">Archives</a> <a class="navbar-item" href="/categories/">Categories</a> <a class="navbar-item" href="/notes/">Notes</a> <a class="navbar-item" href="/about/">About</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column is-12 has-order-2 column-main"><div class="card"><div class="card-content article"><div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto"><div class="level-left"> <time class="level-item has-text-grey" datetime="2020-04-15T15:26:34.000Z">April 15, 2020</time><span class="level-item has-text-grey"><i class="fas fa-user"></i> &nbsp;<a class="has-link-grey" rel="author" href="https://duinomaker.top/">duinomaker</a></span></div></div><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal serif"> 2.1 Introduction to Data Abstraction</h1><div class="content has-math serif"><style>strong{font-weight:500}</style><style>.article .content{font-size:1.2rem}</style><hr><h2 id="Exercise-2-1"><a href="#Exercise-2-1" class="headerlink" title="Exercise 2.1"></a>Exercise 2.1</h2><pre><code>(define (make-rat n d)
  (if (negative? d)
      (cons (- n) (- d))
      (cons n d)))
</code></pre><h2 id="Exercise-2-2"><a href="#Exercise-2-2" class="headerlink" title="Exercise 2.2"></a>Exercise 2.2</h2><pre><code>(define (make-segment p1 p2) (cons p1 p2))
(define (make-point x y) (cons x y))
(define (start-segment s) (car s))
(define (end-segment s) (cdr s))
(define (x-point p) (car p))
(define (y-point p) (cdr p))

(define (midpoint-segment s)
  (let ((p1 (start-segment s))
        (p2 (end-segment s)))
    (make-point (/ (+ (x-point p1) (x-point p2)) 2)
                (/ (+ (y-point p1) (y-point p2)) 2))))
</code></pre><h2 id="Exercise-2-3"><a href="#Exercise-2-3" class="headerlink" title="Exercise 2.3"></a>Exercise 2.3</h2><p>Denote a rectangle with its size (i.e., width and height), and, in consideration for further extensibility, with its origin point and rotation.</p><pre><code>(define (make-rect width height origin rotation)
  (cons (make-size width height)
        (cons origin rotation)))
(define (make-size width height) (cons width height))
(define (get-size rect) (car rect))
(define (size-width size) (car size))
(define (size-height size) (cdr size))
(define (perimeter rect)
  (let ((size (get-size rect)))
    (* (+ (size-width size) (size-height size)) 2)))
(define (area rect)
  (let ((size (get-size rect)))
    (* (size-width size) (size-height size))))
</code></pre><h2 id="Exercise-2-4"><a href="#Exercise-2-4" class="headerlink" title="Exercise 2.4"></a>Exercise 2.4</h2><pre><code>(define (cdr z)
  (z (lambda (p q) q)))
</code></pre><h2 id="Exercise-2-5"><a href="#Exercise-2-5" class="headerlink" title="Exercise 2.5"></a>Exercise 2.5</h2><pre><code>(define (factor-out n factor)
  (define (iter n cnt)
    (if (= (remainder n factor) 0)
        (iter (/ n factor) (+ cnt 1))
        cnt))
  (iter n 0))

(define (cons a b)
  (* (expt 2 a) (expt 3 b)))
(define (car n)
  (factor-out n 2))
(define (cdr n)
  (factor-out n 3))
</code></pre><h2 id="Exercise-2-6"><a href="#Exercise-2-6" class="headerlink" title="Exercise 2.6"></a>Exercise 2.6</h2><pre><code>(define one
  (lambda (f) (lambda (x) (f x))))
(define two
  (lambda (f) (lambda (x) (f (f x)))))
(define (plus m n)
  (lambda (f) (lambda (x) ((m f) ((n f) x)))))
</code></pre><h2 id="Exercise-2-7"><a href="#Exercise-2-7" class="headerlink" title="Exercise 2.7"></a>Exercise 2.7</h2><pre><code>(define (lower-bound intv) (car intv))
(define (upper-bound intv) (cdr intv))
</code></pre><h2 id="Exercise-2-8"><a href="#Exercise-2-8" class="headerlink" title="Exercise 2.8"></a>Exercise 2.8</h2><pre><code>(define (sub-interval x y)
  (make-interval (- (lower-bound x) (upper-bound y))
                 (- (upper-bound x) (lower-bound y))))
</code></pre><h2 id="Exercise-2-9"><a href="#Exercise-2-9" class="headerlink" title="Exercise 2.9"></a>Exercise 2.9</h2><p>For addition and abstraction of two intervals $I_1$ and $I_2$&hairsp;, the width of the result is a function of the widths of the input, namely</p><p>$$\begin{aligned}2\cdot width&amp;=[H(I_1)+H(I_2)]-[L(I_1)+L(I_2)]\\&amp;=[H(I_1)-L(I_1)]+[H(I_2)-L(I_2)]\\&amp;=width_1+width_2\,,\end{aligned}$$</p><p>where $H(I)$ stands for <code>(upper-bound I)</code>&hairsp;, $L(I)$ stands for <code>(lower-bound I)</code>&hairsp;, and $width_1,width_2$ stands for the width of the two intervals, respectively.</p><p>But the equation above doesn’t hold for a multiplication or a division. Presume that the width of the result was a function of the widths of the inputs, then multiplying different intervals with the same widths should give the same answer. But</p><pre><code>[4, 14] * [2, 4] = [8, 56]   (width = 48);
[5, 15] * [1, 3] = [5, 45]   (width = 40).
</code></pre><p>Thus, the presumption turns out to be wrong.</p><h2 id="Exercise-2-10"><a href="#Exercise-2-10" class="headerlink" title="Exercise 2.10"></a>Exercise 2.10</h2><pre><code>(define (div-interval x y)
  (if (&lt;= (* (lower-bound y) (upper-bound y)) 0)
      (error &quot;zero-spanned division error&quot;)
      (mul-interval x
                    (make-interval (/ 1.0 (upper-bound y))
                                   (/ 1.0 (lower-bound y))))))
</code></pre><h2 id="Exercise-2-11"><a href="#Exercise-2-11" class="headerlink" title="Exercise 2.11"></a>Exercise 2.11</h2><p>The answer is WAY longer than the original version. Ben is very mean.</p><pre><code>(define (mul-interval x y)
  (let ((a (lower-bound x))
        (b (upper-bound x))
        (c (lower-bound y))
        (d (upper-bound y)))
    (if (&lt; a 0)
        (if (&lt; b 0)
            (if (&lt; c 0)
                (if (&lt; d 0)
                    (make-interval (* b d) (* a c))
                    (make-interval (* a d) (* a c)))
                (make-interval (* a d) (* b c)))
            (if (&lt; c 0)
                (if (&lt; d 0)
                    (make-interval (* b c) (* a c))
                    (make-interval (min (* b c) (* a d))
                                   (max (* a c) (* b d))))
                (make-interval (* a d) (* b d))))
        (if (&lt; c 0)
            (if (&lt; d 0)
                (make-interval (* b c) (* a d))
                (make-interval (* b c) (* b d)))
            (make-interval (* a c) (* b d))))))
</code></pre><h2 id="Exercise-2-12"><a href="#Exercise-2-12" class="headerlink" title="Exercise 2.12"></a>Exercise 2.12</h2><pre><code>(define (make-center-percent c p)
  (make-center-width c (* c p 0.01)))

(define (percent intv)
  (* (/ (width intv) (center intv)) 100.0))
</code></pre><h2 id="Exercise-2-13"><a href="#Exercise-2-13" class="headerlink" title="Exercise 2.13"></a>Exercise 2.13</h2><p>The actual percentage tolerance is</p><p>$$\frac{w_1w_2(p_1+p_2)}{center}\,,\quad\begin{aligned}&amp;\text{where $w$ denotes width, $p$ denotes percentage tolerance}\\&amp;\text{and $center$ denotes the center of the product interval.}\end{aligned}$$</p><p>Since the tolerance is small enough to ignore the discrepancy between $center$ and $w_1w_2$&hairsp;, the percentage tolerance is $p_1+p_2$ approximately. Thus, we have</p><pre><code>(define (prod-percent-approx a b)
  (+ (percent a) (percent b)))
</code></pre><h2 id="Exercises-2-14–2-16"><a href="#Exercises-2-14–2-16" class="headerlink" title="Exercises 2.14–2.16"></a>Exercises 2.14–2.16</h2><p>All three problems point to the difficulty to introduce <em><strong>“identity”</strong></em> to interval arithmetic.</p><p>Suppose we have two numbers $A$ and $B$&hairsp;, which settles within intervals $I_A=[L_A,H_A]$ and $I_B=[L_B,H_B]$&hairsp;, respectively (assuming that all numbers are positive). Then we’ll have</p><p>$$\frac{I_A}{I_B}=\left[\frac{L_A}{H_B},\frac{H_A}{L_B}\right]$$</p><p>under the definition of interval division. But when we try to divide an interval by itself, we’ll get</p><p>$$\frac{I_A}{I_A}=\left[\frac{L_A}{H_A},\frac{H_A}{L_A}\right]$$</p><p>which is for most of the time not equal to $[1,1]$ as we might have expected.</p><p>The above example illustrates that, the re-appearance of an interval in an expression may well introduce uncertainty to the evaluation. This is because, we never know whether two intervals are related to the same number. In other words, intervals don’t have <em><strong>“identity”</strong></em>.</p><p>Intervals don’t have identity, but real numbers do. I have devised an approach to eliminate these uncertainties. That is, settle the numbers into their corresponding intervals <em><strong>randomly</strong></em> before evaluating the expression. After repeating the “settle-evaluate” loop for say $100,000$ times, we’ll get a decent approximation to the actual interval.</p><p>My approach is inspired by the Monte Carlo methods, which rely on repeated random sampling to obtain numerical results. The approach may be time-consuming since the evaluation has to be carried out a great many times before the approximation becomes precise enough. But it will always give the right answer.</p><p>My code written in Python is given below:</p><figure class="highlight python"><figcaption><span>random-sampling.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">infty = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Interval</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, lower, upper</span>):</span><br><span class="line">        self.lower = lower</span><br><span class="line">        self.upper = upper</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">settle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> random.random() * (self.upper - self.lower) + self.lower</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">from_center_percent</span>(<span class="params">center, percent</span>):</span><br><span class="line">        width = center * percent * <span class="number">0.01</span></span><br><span class="line">        <span class="keyword">return</span> Interval(center - width, center + width)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Interval(%.3f, %.3f)&#x27;</span> % (self.lower, self.upper)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evaluate</span>(<span class="params">func, intervals, precision=<span class="number">100000</span></span>):</span><br><span class="line">    lower, upper = infty, -infty</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(precision):</span><br><span class="line">        val = func(*(i.settle() <span class="keyword">for</span> i <span class="keyword">in</span> intervals))</span><br><span class="line">        <span class="keyword">if</span> val &lt; lower:</span><br><span class="line">            lower = val</span><br><span class="line">        <span class="keyword">if</span> val &gt; upper:</span><br><span class="line">            upper = val</span><br><span class="line">    <span class="keyword">return</span> Interval(lower, upper)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># These two functions accept two arguments,</span></span><br><span class="line">    <span class="comment"># which are values settled for each loop</span></span><br><span class="line">    <span class="comment"># within their corresponding interval.</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func_1</span>(<span class="params">a, b</span>):</span><br><span class="line">        <span class="keyword">return</span> (a * b) / (a + b)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func_2</span>(<span class="params">a, b</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1.0</span> / (<span class="number">1.0</span> / a + <span class="number">1.0</span> / b)</span><br><span class="line"></span><br><span class="line">    I = Interval.from_center_percent</span><br><span class="line">    intervals = [I(<span class="number">100</span>, <span class="number">5</span>), I(<span class="number">10</span>, <span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(evaluate(func_1, intervals))</span><br><span class="line">    <span class="built_in">print</span>(evaluate(func_2, intervals))</span><br></pre></td></tr></table></figure><p>We know <code>par2</code> is the procedure which has its parameters appear only once in its body. So it have no issues with identity.</p><p>And in the random sampling approach, both <code>func_1</code> and <code>func_2</code> evaluate to the same answer, which is equal to the one produced by <code>par2</code>&hairsp;.</p></div></div></div><div class="card"><div class="card-content"><h3 class="title is-5 has-text-weight-normal">Comments</h3><div id="valine-thread" class="content"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>new Valine({el:"#valine-thread",notify:!1,verify:!1,app_id:"jUDJCYuOij3UzEzFmRpQer5U-gzGzoHsz",app_key:"h2AVOMeF8QsLYFdVVbbf9d7k",placeholder:"Suggestions are welcome.",lang:"en"})</script></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start has-text-centered-mobile has-mb-6-mobile"><p>This work is licensed under a <a rel="license noopener external nofollow noreferrer" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons License</a></p></div><div class="level-end has-text-centered-mobile has-mb-5-mobile"><p class="is-size-7">&copy;&nbsp;2020<span style="padding-left:.06em">–</span>2023&nbsp;duinomaker<span>&nbsp;&nbsp;|&nbsp;&nbsp;</span><i class="fas fa-file-word"></i>&nbsp;57.5k&nbsp;words in total<span>&nbsp;&nbsp;|&nbsp;&nbsp;</span><a class="has-link-black-ter" rel="license noopener external nofollow noreferrer" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank"><i class="fab fa-creative-commons"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-nc"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-sa"></i></a></p></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script>var IcarusThemeSettings={site:{url:"https://duinomaker.top",external_link:{enable:!0,exclude:[]}},article:{highlight:{clipboard:!0,fold:"true"}}}</script><script src="https://cdn.jsdelivr.net/npm/clipboard@latest/dist/clipboard.min.js" defer="defer"></script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js" defer="defer"></script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js" defer="defer"></script><script>document.addEventListener("DOMContentLoaded",function(){for(contents=document.getElementsByClassName("has-math"),i=0;i<contents.length;++i)renderMathInElement(contents[i],{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script src="/assets/main.js" defer="defer"></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/assets/content.json"}</script><script src="/assets/insight.js" defer="defer"></script><link rel="stylesheet" href="/assets/search.css"><link rel="stylesheet" href="/assets/insight.css"></body></html>